# obtain a list of supported malware families from ThreatFox

from api_client_details import threatfox_post

def get_malware_list():
    query_params = {"query": "malware_list"}
    malware_fam_res = threatfox_post(query_params)

    if not malware_fam_res:
        print("Oops! No response from ThreatFox")
        return

    data = malware_fam_res.get("data", [])

    if not isinstance(data, dict):
        print("Unexpected response format from ThreatFox API.")
        return

    print("** Here is the list of supported malware families from Threatfox in alphabetical order**")
    for family_id in sorted(data.keys()):
        malware = data[family_id]
        if isinstance(malware, dict):
            print(f"\nMalware family ID: {family_id}")
            print(f"Printable Name: {malware.get('malware_printable', 'N/A')}")
            print(f"Alias: {malware.get('malware_alias', 'N/A')}")
        else:
            print(f"Unexpected entry for {family_id}: {malware}")
